<!DOCTYPE html>
<html>
  <head>
  <title>license Infomation</title>
  <meta name="viewport" content="width=device-width, user-scalable=no">
  <link rel="stylesheet" href="./css/index.css" type="text/css" />
  <script src="./config/conf.js"></script>
  <script src="https://unpkg.com/react@15/dist/react.js"></script>
  <script src="https://unpkg.com/react-dom@15/dist/react-dom.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.8.34/browser.js"></script>
  <script src="https://unpkg.com/react@16/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/html-react-parser@latest/dist/html-react-parser.min.js"></script>
  <script type="text/babel">

  class Navi extends React.Component{
    constructor(props){
      super(props);
      this.handleClick2 = this.handleClick2.bind(this);
      this.handleClick3 = this.handleClick3.bind(this);
    }

    handleClick2(e){
      e.preventDefault();
      location.href="./algorithm.html";
    }
    handleClick3(e){
      e.preventDefault();
      location.href="./databases.html";
    }

    render(){
      return(
        <div className="navigator">
          <div className="active">신기술동향</div>
          <div onClick={this.handleClick2}>알고리즘</div>
          <div onClick={this.handleClick3}>데이터베이스</div>
          <div onClick={()=>alert('준비중')}>전산영어</div>
          <div onClick={()=>alert('준비중')}>업무프로세스</div>
        </div>
      );
    }
  }

  class NewTechnologyInfo extends React.Component{
	constructor(props){
		super(props);
	}
  	render(){

  		return(
  			<div className="postCard">
          <div className="card-head">
            <span className="no">
              {this.props.content.no}
            </span>
            <div className="card-title">
              {HTMLReactParser(this.props.content.ko)}
            </div>
            <div className="card-subinfo">
              <span>영문: <b>{HTMLReactParser(this.props.content.en)}</b></span>
              <span>영문풀네임: <b>{HTMLReactParser(this.props.content.full_en)}</b></span>
            </div>
          </div>
          <div className="card-content">
            {HTMLReactParser(this.props.content.description)}
          </div>
        </div>
  		);
  	}
  }

  class NewTechnology extends React.Component{
  	constructor(props){
  		super(props);

  		this.state = {
  			keyword: '',
        	newTechnologyData: newTechnologyObject
  		}
  		this.handleChange = this.handleChange.bind(this);
    }

  	handleChange(e){
  		this.setState({
  			keyword: e.target.value
  		});
  	}

  	render(){
      const mapToComponents = (data) => {
  			data.sort();
  			﻿
  			data = data.filter(
  				(content) => {
					content.ko = content.ko.replace(/<mark>/gi, "");
					content.ko = content.ko.replace(/<\/mark>/gi, "");	
					content.en = content.en.replace(/<mark>/gi, "");
					content.en = content.en.replace(/<\/mark>/gi, "");	
					content.full_en = content.full_en.replace(/<mark>/gi, "");
					content.full_en = content.full_en.replace(/<\/mark>/gi, "");	
					content.description = content.description.replace(/<mark>/gi, "");
					content.description = content.description.replace(/<\/mark>/gi, "");	

  					return (
              (content.ko.toLowerCase().indexOf(this.state.keyword.toLowerCase()) > -1) ||
              (content.en.toLowerCase().indexOf(this.state.keyword.toLowerCase()) > -1) ||
              (content.full_en.toLowerCase().indexOf(this.state.keyword.toLowerCase()) > -1) ||
              (content.description.toLowerCase().indexOf(this.state.keyword.toLowerCase()) > -1) ||
              ("#"+content.no == this.state.keyword)
            );
  				}
  			)

  			return data.map((content, i)=>{
				if(this.state.keyword != ""){
					content.ko = content.ko.replace(new RegExp(this.state.keyword,"gi"), "<mark>"+this.state.keyword+"</mark>");
					content.en = content.en.replace(new RegExp(this.state.keyword,"gi"), "<mark>"+this.state.keyword+"</mark>");
					content.full_en = content.full_en.replace(new RegExp(this.state.keyword,"gi"), "<mark>"+this.state.keyword+"</mark>");
					content.description = content.description.replace(new RegExp(this.state.keyword,"gi"), "<mark>"+this.state.keyword+"</mark>");
				}
  				return (<NewTechnologyInfo content={content} key={i} />);
  			});
  		}

  		return(
  			<div>
  				<header>
            <h1>신기술동향 단어모음집</h1>
            <div className="searchBox">
              <input name="keyword" placeholder="Search for Keyword" value={this.state.keyword} onChange={this.handleChange}/>
            </div>
          </header>
  				<div className="postCardBox">
            {mapToComponents(this.state.newTechnologyData)}
  				</div>
  			</div>
  		);
  	}
  }

  class App extends React.Component {
    constructor(props){
      super(props);
    }
    render() {
    return (
      <div className="app">
        <NewTechnology />
        <Navi />
      </div>
    );
    }
  }

  ReactDOM.render(<App />, document.getElementById('root'));
  </script>
  </head>

  <body>
    <div id="root"></div>
  </body>
</html>
